# TpRedis - Typecho Redis缓存插件

## 功能简介

TpRedis是一个基于Redis的Typecho缓存插件，用于提升网站性能和并发处理能力。通过将页面内容缓存到Redis中，可以显著减少数据库查询和PHP处理时间，提高网站响应速度。

## 系统要求

- PHP >= 8.0
- Redis >= 6.0
- PHP Redis扩展 >= 5.3.0
- Typecho >= 1.2.0

## 特性

- 支持多种页面类型缓存：首页、归档、文章、附件、分类、标签、作者、搜索、feed、页面等
- 支持Redis密码认证
- 支持Redis数据库选择
- 支持SSL
- 可配置缓存过期时间
- 支持调试模式
- 支持清除所有缓存数据
- 支持对已登录用户禁用缓存
- 自动处理文章更新和评论提交时的缓存更新
- 新增：评论审核批准后自动刷新相关文章和首页缓存
- 新增：评论提交后自动刷新相关文章和首页缓存

## 安装说明

1. 确保服务器已安装Redis和PHP Redis扩展
2. 将插件文件夹重命名为`TpRedis`
3. 将插件文件夹复制到Typecho的`usr/plugins/`目录下
4. 在Typecho后台启用插件
5. 配置Redis连接信息和其他选项

## 配置说明

### 基本设置

- **需要缓存的页面**：选择需要启用缓存的页面类型
- **是否对已登录用户失效**：启用后，已登录用户将不会使用缓存
- **是否支持SSL**：如果网站启用了HTTPS，请开启此选项
- **缓存过期时间**：设置缓存的有效期，默认为86400秒（24小时）

### Redis设置

- **Redis主机地址**：Redis服务器地址，默认为127.0.0.1
- **Redis端口号**：Redis服务器端口，默认为6379
- **Redis密码**：如果Redis服务器设置了密码，请在此填写
- **Redis数据库**：选择使用的Redis数据库编号，默认为0

### 其他设置

- **审核评论后刷新缓存**：开启后，当管理员批准评论时，将自动刷新相关文章和首页缓存
- **是否开启debug**：启用后将在页面显示缓存状态信息
- **清除所有数据**：用于清除所有缓存数据（仅生效一次）

## 性能表现

在标准配置下，插件可以显著提升网站性能：

- 减少数据库查询次数
- 降低服务器CPU使用率
- 提高页面加载速度
- 支持更高的并发访问

## 注意事项

1. 使用缓存后，非JS方式的访问统计插件可能会失效
2. 建议使用第三方评论系统（如Disqus、Gitalk等）
3. 升级插件时请先禁用插件，升级完成后再启用
4. 确保Redis服务器有足够的内存用于缓存

## 更新日志

### 1.1.0
- 新增评论提交和审核批准后自动刷新缓存功能
- 支持刷新相关文章和首页缓存
- 添加配置选项控制审核刷新
- 优化代码结构和错误处理

### 1.0.0
- 初始版本发布
- 支持PHP 8.0+
- 支持Redis 6.0+
- 移除Memcache支持
- 优化代码结构和性能
- 添加更多Redis配置选项

## 作者信息

- 作者：风之翼灵
- 网站：http://www.fungj.com
- 版本：1.1.0

## 许可证

MIT License